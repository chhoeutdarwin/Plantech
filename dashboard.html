<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - UR-Schedule</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <style>
        /* Dashboard Specific Styles */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .dashboard-card {
            background: var(--card-bg-color);
            border-radius: var(--radius-md);
            padding: 24px;
            border: 1px solid var(--border-color);
            transition: all 0.2s ease;
        }

        .dashboard-card:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-hover);
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .card-header h3 {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--accent-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-header i {
            color: var(--primary-color);
        }

        /* Stat Cards */
        .stat-card .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--text-color);
            line-height: 1;
        }

        .stat-card .stat-label {
            font-size: 0.85rem;
            color: var(--accent-color);
            margin-top: 0.5rem;
        }

        .stat-card .stat-change {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
            padding: 3px 8px;
            border-radius: 12px;
            margin-top: 0.75rem;
        }

        .stat-change.positive {
            background: rgba(40, 167, 69, 0.15);
            color: var(--success-color);
        }

        .stat-change.negative {
            background: rgba(220, 53, 69, 0.15);
            color: var(--danger-color);
        }

        /* Progress Ring */
        .progress-ring-container {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }

        .progress-ring {
            position: relative;
            width: 100px;
            height: 100px;
        }

        .progress-ring svg {
            transform: rotate(-90deg);
        }

        .progress-ring circle {
            fill: none;
            stroke-width: 8;
        }

        .progress-ring .bg {
            stroke: var(--border-color);
        }

        .progress-ring .progress {
            stroke: var(--primary-color);
            stroke-linecap: round;
            transition: stroke-dashoffset 0.5s ease;
        }

        .progress-ring .percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1.5rem;
            font-weight: 700;
        }

        .progress-details {
            flex: 1;
        }

        .progress-details h4 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .progress-details p {
            font-size: 0.85rem;
            color: var(--accent-color);
        }

        /* Quick Actions */
        .quick-actions {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .quick-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            padding: 1rem;
            background: var(--bg-color);
            border: none;
            border-radius: 12px;
            color: var(--text-color);
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
        }

        .quick-action-btn:hover {
            background: var(--current-highlight);
            transform: scale(1.02);
        }

        .quick-action-btn i {
            font-size: 1.5rem;
            color: var(--primary-color);
        }

        .quick-action-btn span {
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Today's Tasks */
        .task-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
        }

        .task-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-color);
            border-radius: 10px;
            transition: all 0.2s;
        }

        .task-item:hover {
            background: var(--current-highlight);
        }

        .task-time {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--primary-color);
            min-width: 50px;
        }

        .task-name {
            flex: 1;
            font-size: 0.9rem;
        }

        .task-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .task-status.completed {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
            font-size: 0.7rem;
        }

        /* Streak Calendar */
        .streak-calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .streak-day {
            aspect-ratio: 1;
            border-radius: 6px;
            background: var(--bg-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            color: var(--accent-color);
        }

        .streak-day.active {
            background: var(--primary-color);
            color: white;
        }

        .streak-day.today {
            border: 2px solid var(--primary-color);
        }

        /* Chart Container */
        .chart-container {
            height: 200px;
            position: relative;
        }

        /* Welcome Banner */
        .welcome-banner {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
            border-radius: 16px;
            padding: 2rem;
            color: white;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .welcome-text h1 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }

        .welcome-text p {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .welcome-date {
            text-align: right;
        }

        .welcome-date .day {
            font-size: 3rem;
            font-weight: 700;
            line-height: 1;
        }

        .welcome-date .month-year {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Page Title Bar */
        .page-title-bar {
            background: var(--card-bg-color);
            border-bottom: 1px solid var(--border-color);
            padding: 15px 0;
        }

        .page-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .page-title i {
            color: var(--primary-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-banner {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .welcome-date {
                text-align: center;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <!-- Mobile Sidebar Toggle Button -->
    <button id="sidebar-toggle" class="sidebar-toggle" aria-label="Open sidebar">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Left Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-logo">
            <i class="fas fa-calendar-check"></i>
        </div>
        <nav class="sidebar-nav">
            <a href="dashboard.html" class="sidebar-tab active" title="Dashboard">
                <i class="fas fa-th-large"></i>
                <span>Dashboard</span>
            </a>
            <a href="index.html" class="sidebar-tab" title="Schedule">
                <i class="fas fa-tasks"></i>
                <span>Schedule</span>
            </a>
            <a href="timer.html" class="sidebar-tab" title="Timer">
                <i class="fas fa-stopwatch"></i>
                <span>Timer</span>
            </a>
            <a href="khmer_calendar.html" class="sidebar-tab" title="Khmer Calendar">
                <i class="fas fa-moon"></i>
                <span>·ûÅ·üí·ûò·üÇ·ûö</span>
            </a>
            <a href="world_calendar.html" class="sidebar-tab" title="World Calendar">
                <i class="fas fa-globe"></i>
                <span>World</span>
            </a>
        </nav>
        <div class="sidebar-bottom">
            <button id="dark-mode-toggle" class="sidebar-tab" title="Toggle theme">
                <i class="fas fa-sun"></i>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <div class="main-wrapper">
        <main style="padding: 1.5rem 0;">
            <div class="container">
                <!-- Welcome Banner -->
                <div class="welcome-banner">
                    <div class="welcome-text">
                        <h1>üëã Welcome back!</h1>
                        <p>Here's your productivity overview for today</p>
                    </div>
                    <div class="welcome-date">
                        <div class="day" id="today-day">21</div>
                        <div class="month-year" id="today-month-year">January 2026</div>
                    </div>
                </div>

                <!-- Stats Row -->
                <div class="dashboard-grid">
                    <!-- Tasks Completed -->
                    <div class="dashboard-card stat-card">
                        <div class="card-header">
                            <h3><i class="fas fa-check-circle"></i> Tasks Completed</h3>
                        </div>
                        <div class="stat-value" id="stat-completed">0</div>
                        <div class="stat-label">out of <span id="stat-total">0</span> tasks today</div>
                        <div class="stat-change positive">
                            <i class="fas fa-arrow-up"></i> +12% from yesterday
                        </div>
                    </div>

                    <!-- Current Streak -->
                    <div class="dashboard-card stat-card">
                        <div class="card-header">
                            <h3><i class="fas fa-fire"></i> Current Streak</h3>
                        </div>
                        <div class="stat-value" id="stat-streak">0</div>
                        <div class="stat-label">days in a row</div>
                        <div class="stat-change positive">
                            <i class="fas fa-trophy"></i> Personal best: 14 days
                        </div>
                    </div>

                    <!-- Productivity Score -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3><i class="fas fa-chart-line"></i> Today's Progress</h3>
                        </div>
                        <div class="progress-ring-container">
                            <div class="progress-ring">
                                <svg width="100" height="100">
                                    <circle class="bg" cx="50" cy="50" r="42"></circle>
                                    <circle class="progress" cx="50" cy="50" r="42" 
                                        stroke-dasharray="264" 
                                        stroke-dashoffset="264" 
                                        id="progress-circle"></circle>
                                </svg>
                                <span class="percentage" id="progress-percent">0%</span>
                            </div>
                            <div class="progress-details">
                                <h4>Keep going!</h4>
                                <p>Complete more tasks to boost your score</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Second Row -->
                <div class="dashboard-grid">
                    <!-- Quick Actions -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3><i class="fas fa-bolt"></i> Quick Actions</h3>
                        </div>
                        <div class="quick-actions">
                            <a href="index.html" class="quick-action-btn">
                                <i class="fas fa-plus-circle"></i>
                                <span>Add Task</span>
                            </a>
                            <a href="khmer_calendar.html" class="quick-action-btn">
                                <i class="fas fa-moon"></i>
                                <span>Khmer Calendar</span>
                            </a>
                            <a href="index.html#pomodoro" class="quick-action-btn">
                                <i class="fas fa-clock"></i>
                                <span>Pomodoro</span>
                            </a>
                            <a href="index.html" class="quick-action-btn">
                                <i class="fas fa-chart-bar"></i>
                                <span>View Stats</span>
                            </a>
                        </div>
                    </div>

                    <!-- Today's Tasks -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3><i class="fas fa-list-check"></i> Today's Tasks</h3>
                            <a href="index.html" style="color: var(--primary-color); font-size: 0.8rem;">View all ‚Üí</a>
                        </div>
                        <div class="task-list" id="task-list">
                            <div class="task-item">
                                <span class="task-time">09:00</span>
                                <span class="task-name">No tasks yet</span>
                                <span class="task-status"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Weekly Streak -->
                    <div class="dashboard-card">
                        <div class="card-header">
                            <h3><i class="fas fa-calendar-week"></i> This Week</h3>
                        </div>
                        <div class="streak-calendar" id="streak-calendar">
                            <!-- Generated by JS -->
                        </div>
                        <p style="text-align: center; margin-top: 1rem; font-size: 0.85rem; color: var(--accent-color);">
                            <i class="fas fa-fire" style="color: var(--primary-color);"></i>
                            Complete tasks daily to build your streak!
                        </p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
                // Sidebar toggle for mobile
                const sidebar = document.getElementById('sidebar');
                const sidebarToggle = document.getElementById('sidebar-toggle');
                function toggleSidebar() {
                    sidebar.classList.toggle('sidebar-open');
                }
                sidebarToggle.addEventListener('click', toggleSidebar);
                // Close sidebar when clicking outside on mobile
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 900 && sidebar.classList.contains('sidebar-open')) {
                        if (!sidebar.contains(e.target) && e.target !== sidebarToggle) {
                            sidebar.classList.remove('sidebar-open');
                        }
                    }
                });
        document.addEventListener('DOMContentLoaded', () => {
            // Theme management
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            let isDarkMode = localStorage.getItem('theme') === 'dark';

            function applyTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
                isDarkMode = theme === 'dark';
                const icon = darkModeToggle.querySelector('i');
                if (icon) {
                    icon.className = isDarkMode ? 'fas fa-sun' : 'fas fa-moon';
                }
            }

            applyTheme(isDarkMode ? 'dark' : 'light');

            darkModeToggle.addEventListener('click', () => {
                applyTheme(isDarkMode ? 'light' : 'dark');
            });

            // Apply color theme
            const colorTheme = localStorage.getItem('colorTheme') || 'default';
            document.documentElement.setAttribute('data-color', colorTheme);

            // Update today's date
            const today = new Date();
            document.getElementById('today-day').textContent = today.getDate();
            document.getElementById('today-month-year').textContent = today.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            // Get schedule data from localStorage
            const getDateKey = (date = new Date()) => {
                return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            };

            const getAllSchedules = () => {
                return JSON.parse(localStorage.getItem('allSchedules')) || {};
            };

            const getSchedule = (dateKey = getDateKey()) => {
                const allSchedules = getAllSchedules();
                return allSchedules[dateKey] || {};
            };

            // Update stats
            const schedule = getSchedule();
            const tasks = Object.values(schedule).filter(t => t && t.task);
            const completed = tasks.filter(t => t.completed).length;
            const total = tasks.length;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;

            document.getElementById('stat-completed').textContent = completed;
            document.getElementById('stat-total').textContent = total;
            document.getElementById('progress-percent').textContent = percentage + '%';

            // Update progress ring
            const progressCircle = document.getElementById('progress-circle');
            const circumference = 264; // 2 * PI * 42
            const offset = circumference - (percentage / 100 * circumference);
            progressCircle.style.strokeDashoffset = offset;

            // Get streak
            const streak = parseInt(localStorage.getItem('streak')) || 0;
            document.getElementById('stat-streak').textContent = streak;

            // Render today's tasks
            const taskList = document.getElementById('task-list');
            if (tasks.length > 0) {
                taskList.innerHTML = '';
                Object.entries(schedule)
                    .filter(([_, task]) => task && task.task)
                    .sort(([a], [b]) => parseInt(a) - parseInt(b))
                    .slice(0, 5)
                    .forEach(([hour, task]) => {
                        const item = document.createElement('div');
                        item.className = 'task-item';
                        item.innerHTML = `
                            <span class="task-time">${String(hour).padStart(2, '0')}:00</span>
                            <span class="task-name">${task.task}</span>
                            <span class="task-status ${task.completed ? 'completed' : ''}">
                                ${task.completed ? '<i class="fas fa-check"></i>' : ''}
                            </span>
                        `;
                        taskList.appendChild(item);
                    });
            }

            // Render streak calendar (last 7 days)
            const streakCalendar = document.getElementById('streak-calendar');
            const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            const allSchedules = getAllSchedules();

            for (let i = 6; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                const dateKey = getDateKey(date);
                const daySchedule = allSchedules[dateKey] || {};
                const dayTasks = Object.values(daySchedule).filter(t => t && t.task);
                const hasCompleted = dayTasks.some(t => t.completed);

                const dayEl = document.createElement('div');
                dayEl.className = 'streak-day';
                if (hasCompleted) dayEl.classList.add('active');
                if (i === 0) dayEl.classList.add('today');
                dayEl.textContent = weekDays[date.getDay()];
                dayEl.title = date.toLocaleDateString();
                streakCalendar.appendChild(dayEl);
            }
      });
    </script>
</body>
</html>
